# Безопасность бота

## Настройка безопасности

Для обеспечения безопасности бота необходимо настроить следующие параметры в `.env`:

### 1. OWNER_USER_ID

ID владельца бота в Telegram. Только владелец может добавлять бота в новые чаты и выполнять административные команды.

**Как получить свой User ID:**
1. Напишите боту [@userinfobot](https://t.me/userinfobot)
2. Бот пришлет ваш User ID

**Пример:**
```
OWNER_USER_ID=123456789
```

### 2. ALLOWED_CHAT_IDS

Список ID разрешенных чатов, где бот может работать. Разделяются запятой.

**Как получить ID чата:**
1. Добавьте бота [@getidsbot](https://t.me/getidsbot) в группу
2. Бот пришлет ID группы (отрицательное число для групп)

**Пример:**
```
ALLOWED_CHAT_IDS=-1001234567890,-1009876543210
```

## Механизмы безопасности

### 1. Блокировка личных сообщений

Бот **не работает** в личных сообщениях. Все попытки написать боту в личку будут проигнорированы с сообщением о том, что бот работает только в группах.

### 2. Whitelist чатов

Бот работает **только** в чатах, указанных в `ALLOWED_CHAT_IDS`. Все остальные чаты игнорируются.

### 3. Контроль добавления в группы

- Если бота добавляет **владелец** в новый чат:
  - Бот останется в группе
  - Отправит сообщение о необходимости добавить ID чата в конфигурацию
  - Бот не будет работать до добавления чата в `ALLOWED_CHAT_IDS`

- Если бота добавляет **не владелец**:
  - Бот автоматически покинет группу
  - Отправит предупреждающее сообщение
  - Попытка будет залогирована

### 4. Защита административных команд

Команда `/status` доступна только владельцу бота. Остальные пользователи получат сообщение об отказе в доступе.

## Логирование

Все попытки несанкционированного доступа логируются:
- Попытки доступа из неразрешенных чатов
- Попытки доступа от неавторизованных пользователей
- Попытки добавления бота в группы

## Рекомендации

1. **Никогда не публикуйте** `.env` файл в репозиторий
2. Регулярно проверяйте логи на подозрительную активность
3. Обновляйте список разрешенных чатов только через `.env` файл
4. Храните токен бота и другие секреты в безопасном месте

